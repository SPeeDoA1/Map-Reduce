# PowerGrid AI - Distributed Energy Intelligence Platform

> **Enterprise-Scale MapReduce System for Grid Analytics**
> Built with Apache Spark (PySpark) | No ML Required | Transparent Algorithms

---

## Author Information

| | |
|---|---|
| **Student** | Ali Saad Ezzaldeen |
| **Group** | A |
| **Supervisor** | Dr. Anmar Burhan |

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [System Architecture](#2-system-architecture)
3. [MapReduce Workflow](#3-mapreduce-workflow)
4. [Project Structure](#4-project-structure)
5. [Installation Guide](#5-installation-guide)
6. [Running the System](#6-running-the-system)
7. [Pipeline Deep Dive](#7-pipeline-deep-dive)
8. [Output & Results](#8-output--results)
9. [Configuration](#9-configuration)
10. [Troubleshooting](#10-troubleshooting)

---

## 1. Executive Summary

**PowerGrid AI** is a distributed analytics platform that simulates and optimizes a national energy grid using **Apache Spark's MapReduce paradigm**. Instead of relying on "black box" machine learning models, this system uses **transparent, deterministic MapReduce algorithms** to process massive datasets.

### What It Does

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         POWERGRID AI CAPABILITIES                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. SIMULATE     â†’ Generate realistic grid data (meters, plants, weather)   â”‚
â”‚  2. AGGREGATE    â†’ Sum energy demand by district using MapReduce            â”‚
â”‚  3. OPTIMIZE     â†’ Calculate weather-adjusted power supply                  â”‚
â”‚  4. BALANCE      â†’ Join supply & demand to find blackout risks              â”‚
â”‚  5. DETECT       â†’ Flag fraudulent meters using Z-score statistics          â”‚
â”‚  6. TRACK        â†’ Monitor carbon emissions by plant type                   â”‚
â”‚  7. VISUALIZE    â†’ Dashboard + charts for business intelligence             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Metrics

| Metric | Value |
|--------|-------|
| Smart Meters | ~5,000 simulated |
| Power Plants | 50 (nuclear, coal, gas, hydro, wind, solar) |
| Districts | 10 geographic regions |
| Data Points | ~300,000 readings |
| Processing | < 2 minutes on local machine |

---

## 2. System Architecture

### High-Level Overview

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                              DATA FLOW ARCHITECTURE                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                               â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                         DATA GENERATION LAYER                           â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â•‘
â•‘  â”‚  â”‚Smart Meters  â”‚  â”‚ Power Plants â”‚  â”‚   Weather    â”‚                   â”‚  â•‘
â•‘  â”‚  â”‚  Simulator   â”‚  â”‚  Simulator   â”‚  â”‚  Simulator   â”‚                   â”‚  â•‘
â•‘  â”‚  â”‚   ~5,000     â”‚  â”‚     50       â”‚  â”‚   72 hours   â”‚                   â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘            â”‚                 â”‚                 â”‚                              â•‘
â•‘            â–¼                 â–¼                 â–¼                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                              RAW DATA (CSV)                             â”‚  â•‘
â•‘  â”‚  meter_readings.csv  â”‚  plant_output.csv  â”‚  weather.csv  â”‚  *.csv      â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                      â”‚                                        â•‘
â•‘                                      â–¼                                        â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                     APACHE SPARK PROCESSING LAYER                       â”‚  â•‘
â•‘  â”‚                                                                         â”‚  â•‘
â•‘  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â•‘
â•‘  â”‚   â”‚ Job 1   â”‚   â”‚ Job 2   â”‚   â”‚ Job 3   â”‚   â”‚ Job 4   â”‚   â”‚ Job 5   â”‚   â”‚  â•‘
â•‘  â”‚   â”‚ Demand  â”‚â”€â”€â–¶â”‚ Supply  â”‚â”€â”€â–¶â”‚  Grid   â”‚   â”‚  Fraud  â”‚   â”‚ Carbon  â”‚   â”‚  â•‘
â•‘  â”‚   â”‚Aggreg.  â”‚   â”‚ Optim.  â”‚   â”‚ Balance â”‚   â”‚ Detect  â”‚   â”‚ Track   â”‚   â”‚  â•‘
â•‘  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â•‘
â•‘  â”‚        â”‚             â”‚             â”‚             â”‚             â”‚        â”‚  â•‘
â•‘  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                â–¼                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                         PRESENTATION LAYER                              â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â•‘
â•‘  â”‚  â”‚   Console    â”‚  â”‚  Matplotlib  â”‚  â”‚  CSV/JSON    â”‚                   â”‚  â•‘
â•‘  â”‚  â”‚  Dashboard   â”‚  â”‚   Charts     â”‚  â”‚   Reports    â”‚                   â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TECHNOLOGY STACK                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Language        â”‚  Python 3.8+                                â”‚
â”‚  Big Data        â”‚  Apache Spark 3.x (PySpark)                 â”‚
â”‚  Data Processing â”‚  Pandas, NumPy                              â”‚
â”‚  Data Generation â”‚  Faker                                      â”‚
â”‚  Visualization   â”‚  Matplotlib, Seaborn                        â”‚
â”‚  Console UI      â”‚  Rich (optional)                            â”‚
â”‚  Testing         â”‚  Pytest                                     â”‚
â”‚  Runtime         â”‚  Java 11 or 17 (required for Spark)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. MapReduce Workflow

### What is MapReduce?

MapReduce is a programming model for processing large datasets in parallel:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MAPREDUCE PARADIGM                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   INPUT DATA                MAP PHASE                    REDUCE PHASE       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚                                                                             â”‚
â”‚   [Record 1] â”€â”€â”€â”€â”€â”€â–¶  (key1, value1)  â”€â”€â”                                   â”‚
â”‚   [Record 2] â”€â”€â”€â”€â”€â”€â–¶  (key1, value2)  â”€â”€â”¼â”€â”€â–¶  (key1, [v1,v2,v3]) â”€â”€â–¶ SUM    â”‚
â”‚   [Record 3] â”€â”€â”€â”€â”€â”€â–¶  (key1, value3)  â”€â”€â”˜                                   â”‚
â”‚                                                                             â”‚
â”‚   [Record 4] â”€â”€â”€â”€â”€â”€â–¶  (key2, value4)  â”€â”€â”                                   â”‚
â”‚   [Record 5] â”€â”€â”€â”€â”€â”€â–¶  (key2, value5)  â”€â”€â”¼â”€â”€â–¶  (key2, [v4,v5])    â”€â”€â–¶ SUM    â”‚
â”‚                                         â”‚                                   â”‚
â”‚                                                                             â”‚
â”‚   "Transform each record"      "Group by key"      "Aggregate values"       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### The 5 MapReduce Pipelines

#### Pipeline 1: Demand Aggregation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PIPELINE 1: DEMAND AGGREGATION                                             â”‚
â”‚  Goal: Calculate total energy consumption per district                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  INPUT: meter_readings.csv                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ timestamp, meter_id, district_id, meter_type, kwh, ... â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  MAP: (meter_reading) â”€â”€â–¶ (district_id, kwh)                        â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  Example:                                                           â”‚    â”‚
â”‚  â”‚    {district: "D001", kwh: 5.2} â”€â”€â–¶ ("D001", 5.2)                   â”‚    â”‚
â”‚  â”‚    {district: "D001", kwh: 3.1} â”€â”€â–¶ ("D001", 3.1)                   â”‚    â”‚
â”‚  â”‚    {district: "D002", kwh: 8.7} â”€â”€â–¶ ("D002", 8.7)                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  REDUCE: (district_id, [kwh_list]) â”€â”€â–¶ (district_id, total_kwh)     â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  Example:                                                           â”‚    â”‚
â”‚  â”‚    ("D001", [5.2, 3.1, 2.4, ...]) â”€â”€â–¶ ("D001", 45892.5)             â”‚    â”‚
â”‚  â”‚    ("D002", [8.7, 4.2, 6.1, ...]) â”€â”€â–¶ ("D002", 62341.2)             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚  OUTPUT: Total demand per district                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚ district_id â”‚ total_demand_kwh     â”‚                                     â”‚
â”‚  â”‚ D001        â”‚ 45,892.5             â”‚                                     â”‚
â”‚  â”‚ D002        â”‚ 62,341.2             â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Pipeline 2: Supply Optimization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PIPELINE 2: SUPPLY OPTIMIZATION                                            â”‚
â”‚  Goal: Calculate weather-adjusted power generation per district             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  INPUT: plant_output.csv + weather.csv                                      â”‚
â”‚                                                                             â”‚
â”‚  MAP:  (plant_log) â”€â”€â–¶ (district_id, output_mw)                             â”‚
â”‚                                                                             â”‚
â”‚        Weather adjustments applied:                                         â”‚
â”‚        â€¢ Solar: output Ã— cloud_factor (0.0 - 1.0)                           â”‚
â”‚        â€¢ Wind:  output Ã— wind_factor  (0.0 - 1.0)                           â”‚
â”‚        â€¢ Hydro: output Ã— precipitation_factor                               â”‚
â”‚                                                                             â”‚
â”‚  REDUCE: (district_id, [mw_list]) â”€â”€â–¶ (district_id, total_supply_mw)        â”‚
â”‚                                                                             â”‚
â”‚  OUTPUT: Total supply per district (weather-adjusted)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Pipeline 3: Grid Balancing (JOIN Operation)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PIPELINE 3: GRID BALANCING                                                 â”‚
â”‚  Goal: Identify districts at risk of blackout                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  This pipeline demonstrates the JOIN operation in MapReduce                 â”‚
â”‚                                                                             â”‚
â”‚    DEMAND_RDD                    SUPPLY_RDD                                 â”‚
â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚    (D001, 45892)                 (D001, 50000)                              â”‚
â”‚    (D002, 62341)                 (D002, 45000)   â—„â”€â”€ Deficit!               â”‚
â”‚    (D003, 38291)                 (D003, 40000)                              â”‚
â”‚         â”‚                             â”‚                                     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                        â”‚                                                    â”‚
â”‚                        â–¼                                                    â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚               â”‚      JOIN       â”‚                                           â”‚
â”‚               â”‚  on district_id â”‚                                           â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                        â”‚                                                    â”‚
â”‚                        â–¼                                                    â”‚
â”‚         (district_id, (demand, supply))                                     â”‚
â”‚                        â”‚                                                    â”‚
â”‚                        â–¼                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚  CALCULATE: net_load = supply - demand                        â”‚        â”‚
â”‚    â”‚  FILTER:    net_load < 0  â”€â”€â–¶  BLACKOUT RISK                  â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                        â”‚                                                    â”‚
â”‚                        â–¼                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚ district â”‚ demand  â”‚ supply  â”‚ net_load â”‚ status               â”‚      â”‚
â”‚    â”‚ D001     â”‚ 45,892  â”‚ 50,000  â”‚ +4,108   â”‚ NORMAL               â”‚      â”‚
â”‚    â”‚ D002     â”‚ 62,341  â”‚ 45,000  â”‚ -17,341  â”‚ CRITICAL âš ï¸           â”‚      â”‚
â”‚    â”‚ D003     â”‚ 38,291  â”‚ 40,000  â”‚ +1,709   â”‚ NORMAL               â”‚      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Pipeline 4: Fraud Detection (Statistical Analysis)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PIPELINE 4: FRAUD DETECTION                                                â”‚
â”‚  Goal: Detect energy theft using Z-score statistical analysis               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  TWO-PASS MAPREDUCE ALGORITHM                                               â”‚
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚  â•‘  PASS 1: Calculate Statistics per District                            â•‘  â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£  â”‚
â”‚  â•‘                                                                       â•‘  â”‚
â”‚  â•‘  MAP:    (meter) â”€â”€â–¶ (district_id, (kwh, kwhÂ², 1))                    â•‘  â”‚
â”‚  â•‘                                                                       â•‘  â”‚
â”‚  â•‘  REDUCE: (district_id, values) â”€â”€â–¶ (district_id, sum, sum_sq, count)  â•‘  â”‚
â”‚  â•‘                                                                       â•‘  â”‚
â”‚  â•‘  COMPUTE: mean = sum / count                                          â•‘  â”‚
â”‚  â•‘           variance = (sum_sq / count) - meanÂ²                         â•‘  â”‚
â”‚  â•‘           stddev = âˆšvariance                                          â•‘  â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚  â•‘  PASS 2: Calculate Z-Scores                                           â•‘  â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£  â”‚
â”‚  â•‘                                                                       â•‘  â”‚
â”‚  â•‘  JOIN: meter_data with district_statistics                            â•‘  â”‚
â”‚  â•‘                                                                       â•‘  â”‚
â”‚  â•‘  FORMULA:  Z = (meter_usage - district_mean) / district_stddev        â•‘  â”‚
â”‚  â•‘                                                                       â•‘  â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘  â”‚
â”‚  â•‘  â”‚  Z-Score Interpretation:                                        â”‚  â•‘  â”‚
â”‚  â•‘  â”‚                                                                 â”‚  â•‘  â”‚
â”‚  â•‘  â”‚    Z < -3.0  â”€â”€â–¶  FRAUD LIKELY (under-reporting/theft)          â”‚  â•‘  â”‚
â”‚  â•‘  â”‚   -3.0 to -2.5 â”€â”€â–¶  SUSPICIOUS                                  â”‚  â•‘  â”‚
â”‚  â•‘  â”‚   -2.5 to +2.5 â”€â”€â–¶  NORMAL                                      â”‚  â•‘  â”‚
â”‚  â•‘  â”‚    Z > +3.0  â”€â”€â–¶  ANOMALY (possible meter malfunction)          â”‚  â•‘  â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘  â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                             â”‚
â”‚  VISUAL: Normal Distribution with Fraud Threshold                           â”‚
â”‚                                                                             â”‚
â”‚                            Normal Distribution                              â”‚
â”‚                                   â–²                                         â”‚
â”‚                                  â•±â”‚â•²                                        â”‚
â”‚                                 â•± â”‚ â•²                                       â”‚
â”‚                                â•±  â”‚  â•²                                      â”‚
â”‚                               â•±   â”‚   â•²                                     â”‚
â”‚                              â•±    â”‚    â•²                                    â”‚
â”‚                             â•±     â”‚     â•²                                   â”‚
â”‚                            â•±      â”‚      â•²                                  â”‚
â”‚                           â•±       â”‚       â•²                                 â”‚
â”‚                    â”€â”€â”€â”€â”€â”€â•±â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â•²â”€â”€â”€â”€â”€â”€                          â”‚
â”‚                    â–²              â”‚              â–²                          â”‚
â”‚               Z = -3.0      Mean (Z=0)      Z = +3.0                        â”‚
â”‚                 â”‚                               â”‚                           â”‚
â”‚                 â”‚         99.7% Normal          â”‚                           â”‚
â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚
â”‚                 â”‚                               â”‚                           â”‚
â”‚            FRAUD ZONE                      ANOMALY ZONE                     â”‚
â”‚           (theft likely)                (meter malfunction)                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Pipeline 5: Carbon Tracking

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PIPELINE 5: CARBON FOOTPRINT TRACKER                                       â”‚
â”‚  Goal: Monitor environmental impact by plant type                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  MAP:  (plant_output) â”€â”€â–¶ (plant_type, co2_tons)                            â”‚
â”‚                                                                             â”‚
â”‚        Emission Factors (tons CO2 per MWh):                                 â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚        â”‚ Plant Type â”‚ CO2 Factor   â”‚                                        â”‚
â”‚        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                        â”‚
â”‚        â”‚ Coal       â”‚ 1.0          â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                  â”‚
â”‚        â”‚ Gas        â”‚ 0.4          â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                              â”‚
â”‚        â”‚ Nuclear    â”‚ 0.0          â”‚                                        â”‚
â”‚        â”‚ Hydro      â”‚ 0.0          â”‚                                        â”‚
â”‚        â”‚ Wind       â”‚ 0.0          â”‚                                        â”‚
â”‚        â”‚ Solar      â”‚ 0.0          â”‚                                        â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                             â”‚
â”‚  REDUCE: (plant_type, [co2_list]) â”€â”€â–¶ (plant_type, total_emissions)         â”‚
â”‚                                                                             â”‚
â”‚  ADDITIONAL METRICS:                                                        â”‚
â”‚  â€¢ Renewable percentage (target: 40%)                                       â”‚
â”‚  â€¢ Emission intensity (tons CO2 / MWh generated)                            â”‚
â”‚  â€¢ Carbon status: GREEN / OK / WARNING / CRITICAL                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Complete Execution Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        COMPLETE EXECUTION FLOW                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ./run.sh                                                                  â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ PHASE 1: DATA GENERATION                                            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   [1] Weather Simulator â”€â”€â–¶ weather.csv (72 hours)                  â”‚   â”‚
â”‚   â”‚   [2] Smart Meter Simulator â”€â”€â–¶ meter_readings.csv (~300k records)  â”‚   â”‚
â”‚   â”‚   [3] Power Plant Simulator â”€â”€â–¶ plant_output.csv (3,600 records)    â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ PHASE 2: SPARK INITIALIZATION                                       â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ Create SparkSession (local[*] = all CPU cores)                  â”‚   â”‚
â”‚   â”‚   â€¢ Configure memory (4GB driver, 4GB executor)                     â”‚   â”‚
â”‚   â”‚   â€¢ Set parallelism = 8 partitions                                  â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ PHASE 3: MAPREDUCE ANALYTICS                                        â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   JOB 1 â”€â”€â–¶ Demand Aggregation â”€â”€â–¶ total_demand/                    â”‚   â”‚
â”‚   â”‚       â”‚                                                             â”‚   â”‚
â”‚   â”‚       â–¼                                                             â”‚   â”‚
â”‚   â”‚   JOB 2 â”€â”€â–¶ Supply Optimization â”€â”€â–¶ total_supply/                   â”‚   â”‚
â”‚   â”‚       â”‚                                                             â”‚   â”‚
â”‚   â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚       â–¼                         â–¼                                   â”‚   â”‚
â”‚   â”‚   JOB 3 â”€â”€â–¶ Grid Balancing  JOB 5 â”€â”€â–¶ Carbon Tracking               â”‚   â”‚
â”‚   â”‚       â”‚         â”‚                         â”‚                         â”‚   â”‚
â”‚   â”‚       â”‚         â–¼                         â–¼                         â”‚   â”‚
â”‚   â”‚       â”‚    grid_balance/            carbon/                         â”‚   â”‚
â”‚   â”‚       â”‚                                                             â”‚   â”‚
â”‚   â”‚       â–¼                                                             â”‚   â”‚
â”‚   â”‚   JOB 4 â”€â”€â–¶ Fraud Detection â”€â”€â–¶ fraud/                              â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ PHASE 4: VISUALIZATION                                              â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ Console Dashboard (Rich library)                                â”‚   â”‚
â”‚   â”‚   â€¢ Generate 10 Matplotlib charts â”€â”€â–¶ data/reports/                 â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ COMPLETE!                                                           â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   Results available in:                                             â”‚   â”‚
â”‚   â”‚   â€¢ data/processed/ (CSV outputs from each job)                     â”‚   â”‚
â”‚   â”‚   â€¢ data/reports/   (PNG charts)                                    â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Project Structure

```
PowerGridAI/
â”‚
â”œâ”€â”€ config/                          # Configuration files
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ spark_config.py              # Spark session settings
â”‚   â”œâ”€â”€ grid_parameters.py           # Grid physics & economic constants
â”‚   â””â”€â”€ thresholds.py                # Alert thresholds & limits
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                         # Generated input data
â”‚   â”‚   â”œâ”€â”€ districts.csv            # District metadata
â”‚   â”‚   â”œâ”€â”€ meters.csv               # Meter metadata
â”‚   â”‚   â”œâ”€â”€ meter_readings.csv       # Smart meter readings (~300k rows)
â”‚   â”‚   â”œâ”€â”€ plants.csv               # Power plant metadata
â”‚   â”‚   â”œâ”€â”€ plant_output.csv         # Plant generation data
â”‚   â”‚   â””â”€â”€ weather.csv              # Weather conditions
â”‚   â”‚
â”‚   â”œâ”€â”€ processed/                   # MapReduce outputs
â”‚   â”‚   â”œâ”€â”€ demand/                  # Job 1 results
â”‚   â”‚   â”œâ”€â”€ supply/                  # Job 2 results
â”‚   â”‚   â”œâ”€â”€ balance/                 # Job 3 results
â”‚   â”‚   â”œâ”€â”€ fraud/                   # Job 4 results
â”‚   â”‚   â””â”€â”€ carbon/                  # Job 5 results
â”‚   â”‚
â”‚   â””â”€â”€ reports/                     # Generated charts (PNG)
â”‚       â”œâ”€â”€ demand_by_district.png
â”‚       â”œâ”€â”€ demand_by_type.png
â”‚       â”œâ”€â”€ supply_by_type.png
â”‚       â”œâ”€â”€ capacity_utilization.png
â”‚       â”œâ”€â”€ grid_balance.png
â”‚       â”œâ”€â”€ fraud_zscore_dist.png
â”‚       â”œâ”€â”€ fraud_status_dist.png
â”‚       â”œâ”€â”€ emissions_by_type.png
â”‚       â”œâ”€â”€ hourly_emissions.png
â”‚       â””â”€â”€ renewable_mix.png
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ data_generation/             # Synthetic data generators
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ smart_meter_simulator.py # Generates meter readings
â”‚   â”‚   â”œâ”€â”€ power_plant_simulator.py # Generates plant output
â”‚   â”‚   â””â”€â”€ weather_simulator.py     # Generates weather data
â”‚   â”‚
â”‚   â”œâ”€â”€ spark_jobs/                  # MapReduce pipelines
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ demand_aggregator.py     # Pipeline 1: Demand aggregation
â”‚   â”‚   â”œâ”€â”€ supply_optimizer.py      # Pipeline 2: Supply optimization
â”‚   â”‚   â”œâ”€â”€ grid_balancer.py         # Pipeline 3: Grid balancing
â”‚   â”‚   â”œâ”€â”€ fraud_detector.py        # Pipeline 4: Fraud detection
â”‚   â”‚   â””â”€â”€ carbon_tracker.py        # Pipeline 5: Carbon tracking
â”‚   â”‚
â”‚   â”œâ”€â”€ visualization/               # Output & display
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ dashboard.py             # Console dashboard (Rich)
â”‚   â”‚   â””â”€â”€ charts.py                # Matplotlib visualizations
â”‚   â”‚
â”‚   â””â”€â”€ main.py                      # Main orchestrator
â”‚
â”œâ”€â”€ tests/                           # Unit tests
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_data_generation.py
â”‚
â”œâ”€â”€ requirements.txt                 # Python dependencies
â”œâ”€â”€ run.sh                           # One-click execution script
â””â”€â”€ README.md                        # This file
```

---

## 5. Installation Guide

### Prerequisites

| Requirement | Version | Check Command |
|-------------|---------|---------------|
| Python | 3.8+ | `python3 --version` |
| Java | 11 or 17 | `java -version` |
| pip | Latest | `pip --version` |

### Step 1: Install Java 17

**macOS (Homebrew):**
```bash
brew install openjdk@17
```

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install openjdk-17-jdk
```

**Windows:**
Download from [Adoptium](https://adoptium.net/temurin/releases/?version=17)

### Step 2: Clone/Download the Project

```bash
cd /path/to/your/projects
# If cloning from git:
# git clone <repository-url>
cd PowerGridAI
```

### Step 3: Create Virtual Environment

```bash
# Create virtual environment
python3 -m venv venv

# Activate it
# macOS/Linux:
source venv/bin/activate
# Windows:
# venv\Scripts\activate

# Upgrade pip
pip install --upgrade pip
```

### Step 4: Install Dependencies

```bash
pip install -r requirements.txt
```

### Step 5: Verify Installation

```bash
# Check PySpark
python3 -c "import pyspark; print(f'PySpark {pyspark.__version__} installed')"

# Check other dependencies
python3 -c "import pandas, numpy, faker, matplotlib; print('All dependencies OK')"
```

---

## 6. Running the System

### Quick Start (Recommended)

```bash
# Make script executable (first time only)
chmod +x run.sh

# Run the full pipeline
./run.sh
```

### Command Line Options

```bash
# Generate new data and run analytics
./run.sh

# Force regenerate all data
./run.sh --regenerate

# Skip data generation (use existing data)
./run.sh --skip-data

# Skip chart generation
./run.sh --skip-charts

# Show help
./run.sh --help
```

### Manual Execution

```bash
# Activate virtual environment
source venv/bin/activate

# Set Java (if needed)
export JAVA_HOME=$(/usr/libexec/java_home -v 17)  # macOS
# export JAVA_HOME=/usr/lib/jvm/java-17-openjdk   # Linux

# Run
python -m src.main
```

### Expected Output

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                           â•‘
â•‘   âš¡ PowerGrid AI - Distributed Energy Intelligence Platform              â•‘
â•‘                                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

======================================================================
PHASE 1: DATA GENERATION
======================================================================
[1/3] Generating weather data...
[2/3] Generating smart meter data...
[3/3] Generating power plant data...
âœ… Data generation complete!

======================================================================
PHASE 2: MAPREDUCE ANALYTICS
======================================================================
JOB 1: DEMAND AGGREGATION
  MAP phase: (meter_log) -> (district_id, kwh)
  REDUCE phase: (district_id, [kwh_list]) -> (district_id, total_demand)
  âœ… Aggregated demand for 10 districts

JOB 2: SUPPLY OPTIMIZATION
  ...

JOB 3: GRID BALANCING
  ...

JOB 4: FRAUD DETECTION
  ...

JOB 5: CARBON TRACKING
  ...

======================================================================
PHASE 3: DASHBOARD
======================================================================
[Dashboard output with tables and metrics]

======================================================================
EXECUTION COMPLETE
======================================================================
ğŸ“ Data directory: data/
ğŸ“Š Reports directory: data/reports/
â±ï¸  Completed at: 2024-06-15 14:32:45
```

---

## 7. Pipeline Deep Dive

### Data Generation Details

#### Smart Meter Simulator

```python
# Generates realistic consumption patterns based on:
# - Meter type (residential, commercial, industrial)
# - Time of day (hourly patterns)
# - Day of week (weekend vs weekday)
# - Random variation (10-20%)
# - Fraud injection (2% of meters report low values)

# Example hourly pattern for residential:
hourly_pattern = [
    0.4, 0.3, 0.3, 0.3, 0.4, 0.6,  # 0-5am  (low - sleeping)
    0.9, 1.2, 1.0, 0.7, 0.6, 0.7,  # 6-11am (morning rush)
    0.8, 0.7, 0.7, 0.8, 1.0, 1.4,  # 12-5pm (afternoon)
    1.6, 1.5, 1.3, 1.0, 0.7, 0.5,  # 6-11pm (evening peak)
]
```

#### Weather Impact on Renewables

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WEATHER IMPACT FACTORS                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  SOLAR GENERATION:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  â”‚ Cloud Condition â”‚ Factor     â”‚                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                             â”‚
â”‚  â”‚ Clear           â”‚ 1.0 (100%) â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â”‚
â”‚  â”‚ Partly Cloudy   â”‚ 0.7 (70%)  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              â”‚
â”‚  â”‚ Cloudy          â”‚ 0.3 (30%)  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                      â”‚
â”‚  â”‚ Overcast        â”‚ 0.1 (10%)  â”‚ â–ˆâ–ˆ                          â”‚
â”‚  â”‚ Rainy           â”‚ 0.05 (5%)  â”‚ â–ˆ                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                               â”‚
â”‚  WIND GENERATION:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  â”‚ Wind Speed      â”‚ Factor     â”‚                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                             â”‚
â”‚  â”‚ Calm (<3 m/s)   â”‚ 0.0 (0%)   â”‚                             â”‚
â”‚  â”‚ Light (3-6)     â”‚ 0.3 (30%)  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                      â”‚
â”‚  â”‚ Moderate (6-12) â”‚ 0.7 (70%)  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              â”‚
â”‚  â”‚ Strong (12-25)  â”‚ 1.0 (100%) â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â”‚
â”‚  â”‚ Extreme (>25)   â”‚ 0.0 (0%)   â”‚ (shutdown for safety)       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Spark Configuration

```python
# Key Spark settings (config/spark_config.py)
SparkSession.builder
    .master("local[*]")           # Use all CPU cores
    .config("spark.driver.memory", "4g")
    .config("spark.executor.memory", "4g")
    .config("spark.sql.shuffle.partitions", "8")
    .config("spark.default.parallelism", "8")
```

---

## 8. Output & Results

### Sample Dashboard Output

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                           GRID BALANCE RESULTS                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘  District  â”‚ Demand (MWh) â”‚ Supply (MW) â”‚ Net Load â”‚ Status              â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘  D000      â”‚    12,543.2  â”‚   15,000.0  â”‚  +2,456  â”‚ âœ… NORMAL           â•‘
â•‘  D001      â”‚     8,921.5  â”‚    6,500.0  â”‚  -2,421  â”‚ âš ï¸  CRITICAL         â•‘
â•‘  D002      â”‚    15,234.1  â”‚   18,000.0  â”‚  +2,765  â”‚ âœ… NORMAL           â•‘
â•‘  D003      â”‚     5,432.8  â”‚    5,800.0  â”‚    +367  â”‚ âœ… OK               â•‘
â•‘  ...       â”‚              â”‚             â”‚          â”‚                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  BLACKOUT RISK SUMMARY                                                   â•‘
â•‘  â€¢ Districts at Risk: 2                                                  â•‘
â•‘  â€¢ Total Deficit: -4,892 MW                                              â•‘
â•‘  â€¢ Critical Districts: D001, D007                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          FRAUD DETECTION SUMMARY                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Meters Analyzed:        5,234                                           â•‘
â•‘  Fraud Cases Detected:     112                                           â•‘
â•‘  Fraud Rate:             2.14%                                           â•‘
â•‘  Est. Stolen Energy:    45,231 kWh                                       â•‘
â•‘  Est. Revenue Loss:    $5,427.78                                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                           CARBON FOOTPRINT                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Total Emissions:      12,456.32 tons CO2                                â•‘
â•‘  Emission Intensity:   0.234 tons/MWh                                    â•‘
â•‘  Renewable %:          38.5%                                             â•‘
â•‘  Target (40%):         âŒ Not Met                                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Generated Charts

| Chart | Description | File |
|-------|-------------|------|
| Demand by District | Bar chart of total kWh per district | `demand_by_district.png` |
| Demand by Type | Pie chart (residential/commercial/industrial) | `demand_by_type.png` |
| Supply by Type | Bar chart by plant type | `supply_by_type.png` |
| Capacity Utilization | Horizontal bar chart | `capacity_utilization.png` |
| Grid Balance | Balance status by district | `grid_balance.png` |
| Z-Score Distribution | Histogram with fraud thresholds | `fraud_zscore_dist.png` |
| Fraud Status | Bar chart of meter statuses | `fraud_status_dist.png` |
| Emissions by Type | Pie chart of CO2 sources | `emissions_by_type.png` |
| Hourly Emissions | Line chart over 24 hours | `hourly_emissions.png` |
| Renewable Mix | Pie chart renewable vs fossil | `renewable_mix.png` |

---

## 9. Configuration

### Grid Parameters (`config/grid_parameters.py`)

```python
# Adjust these to change simulation scale
NUM_DISTRICTS = 10              # Number of geographic regions
SIMULATION_DAYS = 3             # Days of data to generate

# Meters per district (by type)
DISTRICT_TYPES = {
    "industrial":  {"meters_range": (100, 300)},
    "commercial":  {"meters_range": (200, 500)},
    "residential": {"meters_range": (500, 1000)},
    "mixed":       {"meters_range": (300, 600)},
}

# Power plant capacities (MW)
PLANT_BASE_CAPACITY = {
    "nuclear": 1000,
    "coal": 600,
    "gas": 400,
    "hydro": 300,
    "wind": 150,
    "solar": 100,
}
```

### Thresholds (`config/thresholds.py`)

```python
# Grid stability
CRITICAL_DEFICIT = -0.15   # Below -15% = blackout risk
WARNING_DEFICIT = -0.05    # Below -5% = warning

# Fraud detection
FRAUD_ZSCORE_CRITICAL = 3.0   # |Z| > 3 = likely fraud
FRAUD_ZSCORE_WARNING = 2.5    # |Z| > 2.5 = suspicious

# Carbon targets
RENEWABLE_TARGET = 0.40    # 40% renewable goal
EMISSION_TARGET = 0.2      # tons CO2/MWh target
```

---

## 10. Troubleshooting

### Common Issues

#### Java Version Error

```
Error: Java 25 detected. Apache Spark requires Java 11 or 17.
```

**Solution:**
```bash
# Install Java 17
brew install openjdk@17  # macOS

# The run.sh script auto-detects Java 17 from Homebrew
./run.sh
```

#### Memory Error

```
java.lang.OutOfMemoryError: Java heap space
```

**Solution:** Edit `config/spark_config.py`:
```python
.config("spark.driver.memory", "8g")  # Increase from 4g
```

#### Data Not Found

```
Error: Data not found at data/raw/meter_readings.csv
```

**Solution:**
```bash
# Regenerate data
./run.sh --regenerate
```

#### Spark Stage Stuck

If processing seems stuck at `[Stage X: (0 + 8) / 8]`:

1. This is normal for large datasets
2. Wait - it's processing in parallel
3. Check `data/raw/meter_readings.csv` size
4. Reduce data size in `config/grid_parameters.py`

### Performance Tips

1. **Reduce data size** for faster testing:
   ```python
   # In grid_parameters.py
   SIMULATION_DAYS = 1
   NUM_DISTRICTS = 5
   ```

2. **Install psutil** to eliminate warnings:
   ```bash
   pip install psutil
   ```

3. **Use SSD** - Spark writes shuffle data to disk

4. **Close other applications** - Spark uses all CPU cores

---

## License

MIT License - Free for educational and commercial use.

---

## Acknowledgments

Special thanks to **Dr. Anmar Burhan** for supervision and guidance on this project.

### Technologies Used
- Apache Spark team for the distributed computing framework
- Faker library for realistic data generation
- Rich library for beautiful console output
- Matplotlib for data visualization

---


```
   ___                        ___      _     _     _    ___
  / _ \_____      _____ _ __ / _ \_ __(_) __| |   / \  |_ _|
 / /_)/ _ \ \ /\ / / _ \ '__/ /_\/ '__| |/ _` |  / _ \  | |
/ ___/ (_) \ V  V /  __/ | / /_\\| |  | | (_| | / ___ \ | |
\/    \___/ \_/\_/ \___|_| \____/|_|  |_|\__,_|/_/   \_\___|

       Distributed Energy Intelligence Platform
```
